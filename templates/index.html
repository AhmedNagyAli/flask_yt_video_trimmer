<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>YT Video Trimmer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @keyframes blink {
      0%, 100% { border-color: transparent }
      50% { border-color: black }
    }
    .typewriter {
      border-right: 2px solid black;
      white-space: nowrap;
      overflow: hidden;
      animation: blink 0.75s step-end infinite;
    }
  </style>
</head>
<body class="bg-gray-100 flex flex-col items-center min-h-screen px-4 py-8 relative">

  <!-- Typewriter Message Above the App -->
  <div class="mb-6 text-center max-w-xl w-full px-4">
    <p id="topTypewriterEN" class="typewriter text-gray-800 text-sm sm:text-base font-medium h-6 sm:h-8"></p>
    <p id="topTypewriterAR" class="typewriter text-gray-800 text-sm sm:text-base font-medium h-6 sm:h-8" dir="rtl"></p>
  </div>

  <!-- Modal -->
  <div id="loadingModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center hidden z-50 px-4">
    <div class="bg-white px-6 py-6 sm:px-10 sm:py-8 rounded-2xl flex flex-col items-center space-y-4 sm:space-y-6 w-full max-w-sm sm:max-w-md shadow-2xl">
      <svg class="w-12 h-12 sm:w-16 sm:h-16 text-indigo-600 animate-spin" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
      </svg>
      <p id="typewriterText" class="text-lg sm:text-xl font-semibold text-gray-800 typewriter w-full text-center h-8 sm:h-10"></p>
    </div>
  </div>

  <!-- Form Container -->
  <div class="bg-white p-4 sm:p-6 rounded shadow-md w-full max-w-sm sm:max-w-md z-10">
    <h1 class="text-lg sm:text-xl font-bold mb-4 text-center">🎥 YT Video Trimmer</h1>

    {% if error %}
      <div class="mb-4 text-red-600 bg-red-100 border border-red-400 p-2 rounded text-sm text-center">
        {{ error }}
      </div>
    {% endif %}

    <form method="POST" id="downloadForm" class="space-y-4">
      <input
        type="text"
        name="youtube_url"
        placeholder="Enter YouTube URL"
        class="w-full p-2 border border-gray-300 rounded"
        required
      >
      <button
        type="submit"
        id="submitBtn"
        class="w-full bg-indigo-700 text-white p-2 rounded hover:bg-blue-600 flex justify-center items-center"
      >
        <span id="buttonText">Get Resolutions</span>
        <svg
          id="spinner"
          class="hidden w-5 h-5 ml-2 text-white animate-spin"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
        >
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path
            class="opacity-75"
            fill="currentColor"
            d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
          ></path>
        </svg>
      </button>
    </form>
  </div>

  <!-- Scripts -->
  <script>
    const form = document.getElementById('downloadForm');
    const modal = document.getElementById('loadingModal');
    const typewriter = document.getElementById('typewriterText');
    const message = "Processing the video resolutions...";
    let index = 0;
    let isDeleting = false;

    function loopTypewriter() {
      let currentText = typewriter.textContent;

      if (!isDeleting) {
        typewriter.textContent = message.substring(0, index + 1);
        index++;
        if (index === message.length) {
          isDeleting = true;
          setTimeout(loopTypewriter, 1000);
          return;
        }
      } else {
        typewriter.textContent = message.substring(0, index - 1);
        index--;
        if (index === 0) {
          isDeleting = false;
        }
      }

      setTimeout(loopTypewriter, 60);
    }

    form.addEventListener('submit', function () {
      document.getElementById('submitBtn').disabled = true;
      document.getElementById('buttonText').textContent = 'Processing...';
      document.getElementById('spinner').classList.remove('hidden');
      modal.classList.remove('hidden');
      loopTypewriter();
    });

    // Top message animation
    const topEN = document.getElementById('topTypewriterEN');
    const topAR = document.getElementById('topTypewriterAR');

    const messageEN = "Since it is a free hosting it only works on small videos and still have problems and may crash many times till you can get your video ...sorry for that and we hope you wait for the final version";
    const messageAR = "نظرًا لأنه استضافة مجانية ، فإنه يعمل فقط على مقاطع الفيديو الصغيرة ولا يزال يعاني من مشاكل وقد يتعطل عدة مرات حتى تتمكن من الحصول على الفيديو الخاص بك ... نأسف لذلك ونأمل أن تنتظر الإصدار النهائي";

    let enIndex = 0;
    let arIndex = 0;

    function typeTopMessage() {
      if (enIndex <= messageEN.length) {
        topEN.textContent = messageEN.substring(0, enIndex++);
      }
      if (arIndex <= messageAR.length) {
        topAR.textContent = messageAR.substring(0, arIndex++);
      }

      if (enIndex <= messageEN.length || arIndex <= messageAR.length) {
        setTimeout(typeTopMessage, 50);
      }
    }

    window.addEventListener('load', typeTopMessage);
  </script>
</body>

</html>
